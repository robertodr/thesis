% mainfile: ../RobertoDiRemigioPhDThesis.tex

\renewcommand{\thefigure}{\arabic{chapter}.\arabic{figure}}

\chapter{A Quick Tour of Molecular Electronic Structure Theory}\label{ch:QM}

This Chapter presents a brief overview of molecular electronic structure
theory with particular emphasis on the methods used in this thesis.
Section \ref{sec:mqm} is a general introduction to the methods of
molecular quantum mechanics, relativistic or nonrelativistic.
I will provide a brief introduction to the language of second
quantization, used throughout the thesis.
Section \ref{sec:mean-field} presents the mean-field approximation to
the molecular electronic structure problem, the workhorse of quantum
chemistry.
Sections \ref{sec:coupled-cluster}--\ref{sec:cc-approximate} are
concerned with the \gls{CC} and \gls{MBPT} methods for the inclusion of
electron correlation.

\section{Molecular Quantum Mechanics}\label{sec:mqm}

Quantum mechanics is the theory describing the motion and interactions
of microscopic particles. In quantum theory every observable of the
system is represented mathematically by an operator $O$ in the
appropriate Hilbert space of \emph{wave functions}.
A wave function $\psi$ is the mathematical object describing the state of the
system. In the usual Copenhagen interpretation of quantum mechanics, the
modulus square of the wave function $|\psi|^2$ provides the key to
predicting experimentally measurable quantities.\autocite{Konishi2009-zb}
The wave function $\psi$ is the solution to the Schr\"{o}dinger equation:
\begin{equation}\label{eq:schrodinger}
  H\psi = E\psi
\end{equation}
where $H$ is the \emph{Hamiltonian} operator and $E$ is the energy of
the system. The Schr\"{o}dinger equation is an eigenvalue equation for
the Hamiltonian operator and $\psi$ is thus an
eigenfunction.\autocite{Arfken2013-pt}

Molecular quantum mechanics is concerned with the microscopic motion of
nuclei and electrons in molecules and is thus an intrinsically many-body
theory. The problem is clearly very complicated to solve, as the number of
interactions to be considered is large.
Since the nuclei are much heavier than the electrons, the \gls{BO} or
clamped-nuclei approximation is typically assumed. The nuclei are fixed
in a specific configuration (called a \emph{molecular geometry}) and
treated as static electric sources.\autocite{Born1927-ce}
This separation of motions results in an electron-only Hamiltonian and
an electronic wave function that depends \emph{parametrically} on the
nuclear positions. The eigenvalue of this Hamiltonian, also dependent on
the nuclear positions, is the \gls{PES} of the system, that is the
potential function in which the nuclei move.\autocite{Szabo1989-vl,
McWeeny1992-oj}
In first quantization, the general expression for the clamped-nuclei,
$N$-electron, molecular electronic Hamiltonian is:
\begin{alignat}{2}\label{eq:fq-hamiltonian}
  H = \sum_{i=1}^N h(\vect{r}_i)
  + \frac{1}{2}\sum_{i\neq j}^N g(\vect{r}_i, \vect{r}_j)
  + V_\mathrm{NN},
  \quad&
  V_\mathrm{NN} =
  \frac{1}{2}\sum_{A \neq B}^{N_\mathrm{nuclei}}\frac{Z_A Z_B}{|\vect{R}_A - \vect{R}_B|}
\end{alignat}
The last term is the nuclear repulsion energy, a constant shift of the
energy scale in the \acrshort{BO} approximation.
As noted by \citeauthor{Saue2011-qg}, the same general expression for
the clamped-nuclei Hamiltonian Eq.~\eqref{eq:fq-hamiltonian} is valid in
the nonrelativistic and relativistic no-pair
regimes.\autocite{Sucher1980-vf, Saue2011-qg}
In the nonrelativistic domain one defines the one- and two-electron
operators as:\autocite{Szabo1989-vl, McWeeny1992-oj, Konishi2009-zb}
\begin{subequations}
 \begin{align}
   h(\vect{r}_i) &=
   -\frac{1}{2}\nabla^2_i + V_\mathrm{Ne}(\vect{r}_i)
   = -\frac{1}{2}\nabla^2_i - \sum_{A=1}^{N_\mathrm{nuclei}}\frac{Z_A}{|\vect{R}_A -
   \vect{r}_i|} \label{eq:h} \\
   g(\vect{r}_i, \vect{r}_j) &= \frac{1}{|\vect{r}_i - \vect{r}_j|},
   \label{eq:g-coulomb}
 \end{align}
\end{subequations}
while in the relativistic regime with the \gls{DC}
approximation:\autocite{Dyall2007-tu, Konishi2009-zb, Reiher2014-cp}
\begin{subequations}
 \begin{align}
   h(\vect{r}_i) &= (\mat{\beta} - I_4)\si{\electronmass}c^2 +
   c(\mat{\alpha}_i\cdot\vect{p}_i) + V_{\mathrm{Ne}}(\vect{r}_i)I_4 \\
   g(\vect{r}_i, \vect{r}_j) &= \frac{I_4\cdot I_4}{|\vect{r}_i - \vect{r}_j|}
   \label{eq:g-r-coulomb}
 \end{align}
\end{subequations}
The Dirac matrices, expressed in terms of the vector $\mat{\sigma}$
collecting the three Pauli spin matrices, were introduced:
\begin{alignat}{2}
  \mat{\alpha}_i =
  \begin{pmatrix}
    0_2 & \mat{\sigma}_i \\
    \mat{\sigma}_i & 0_2
  \end{pmatrix},
  \quad&
  \mat{\beta} =
  \begin{pmatrix}
    I_2 & 0_2 \\
    0_2 & -I_2
  \end{pmatrix},
\end{alignat}
and the operators are implicitly assumed to embed the proper no-pair,
positive-energy manifold projectors.\autocite{Sucher1980-vf}
Since these are fermionic Hamiltonians, the spin-statistics theorem
dictates the corresponding eigenfunctions to be
antisymmetric.
Using the expansion theorem,\autocite{Gross1991-hi} we seek the wave
function for the $N$-electron system as a linear combination of
$N$-electron \emph{Slater determinants}.

It the language of second quantization, we assume that a, not
necessarily complete, set of orthonormal one-particle states is
available. These are usually called \glspl{MO}.
In general, we would like to embed as many of the symmetries of the
system into the one-particle basis. This is accomplished by requiring
the one-particle space to be the common eigenbasis for a complete set of
suitable, commuting one-particle operators.\autocite{Gross1991-hi}
Any $N$-particle state can be constructed by distributing particles
into one-particle states and accordingly labelling them by the number of
particles per one-particle states present.
This is the so-called \gls{ON} vector representation:
\begin{equation}
  \ket{\vect{n}} = \ket{n1,n2,\ldots},
\end{equation}
and the span of all \acrshort{ON} vectors is called the \emph{Fock
space} $F^N$, a space isomorphic to the Hilbert space $H^N$ of
$N$-particle wave functions.
To preserve consistency, the \emph{vacuum} state with no particles:
\begin{equation}
 \ket{\mathrm{vac}} = \ket{0,0,\ldots}
\end{equation}
is included in the construction of Fock space.
Any $N$-particle state can be generated by application of
\emph{creation} operators $\cons{i}$. Creation operators increase the
occupation number in the one-particle state $i$ by $1$, up to a phase.
Conversely, \emph{annihilation} operators $\anni{i}$, defined as the Hermitian
conjugates of the creation operators, decrease occupation in state $i$
by $1$, again up to a phase. Clearly, annihilation of any one-particle
state in the vacuum results yields $0$.
Pauli's exclusion principle is enforced by the \emph{canonical
anticommutation relations}:
\begin{subequations}
  \begin{align}
    \cons{r}\cons{s} + \cons{s}\cons{r} &= 0 \\
    \anni{r}\anni{s} + \anni{s}\anni{r} &= 0 \\
    \cons{r}\anni{s} + \anni{s}\cons{r} &= \delta_{rs},
  \end{align}
\end{subequations}
showing how the construction of the Fock space representation
embeds antisymmetry at the operator level and not in the wave functions.
Finally, the second-quantized molecular electronic Hamiltonian in the \acrlong{BO}
approximation is:\autocite{Helgaker2000-tz, Shavitt2009-mr}
\begin{equation}\label{eq:sq-hamiltonian}
  H = \sum_{rs}h_{rs}\cons{r}\anni{s}
  + \frac{1}{2}\sum_{rstu}g_{rstu}\cons{r}\cons{t}\anni{u}\anni{s}
  + V_\mathrm{NN}
\end{equation}
where the matrix elements are given as integrals over the chosen
one-particle basis:
\begin{subequations}
 \begin{align}
   h_{rs} &= \int \diff\vect{r} \phi_r^\dagger(\vect{r}) h(\vect{r})\phi_s(\vect{r}) \label{eq:one-el}\\
   g_{rstu} &=
   \int\diff\vect{r}\int\diff\vect{r}^\prime
   \Omega_{rs}(\vect{r}) g(\vect{r},\vect{r}^\prime) \Omega_{tu}(\vect{r}^\prime) \label{eq:two-el} \\
  \Omega_{rs}(\vect{r}) &= \phi_r^\dagger(\vect{r})\phi_s(\vect{r}). \label{eq:overlap}
 \end{align}
\end{subequations}
The second-quantized Hamiltonian Eq.~\eqref{eq:sq-hamiltonian} is thus a
\emph{projected} operator, exact only within the subspace determined by
the chosen one-particle set.~\autocite{Gross1991-hi, Helgaker2000-tz}

In second quantization, the exact molecular electronic wave function can
be written as a linear combination of \acrshort{ON} vectors:
\begin{equation}\label{eq:fci}
  \ket{\psi} = \sum_{\vect{k}}C_\vect{k}\ket{\vect{k}},
\end{equation}
also known at the \gls{FCI} expansion.
Among the many properties the exact wave function enjoys, the
\emph{variational} property and \emph{size-extensivity} are the ones
that are almost always embedded into approximate wave function ans\"{a}tze.\autocite{Helgaker2000-tz}
According to the former, the energy is stable with respect to orthogonal
variations of the wave function. In practice this guarantees that
minimization with respect to the parameters of a well-crafted ansatz
ensures convergence from above to the exact energy.\autocite{Szabo1989-vl, McWeeny1992-oj, Helgaker2000-tz}
A wave function ansatz enjoying the latter property guarantees that the
energy of a system made of noninteracting subsystems is equal to the sum of
the energies of the isolated subsystems.\autocite{Helgaker2000-tz, Nooijen2005-ux}

Coefficients in the \acrshort{FCI} expansion in Eq. \eqref{eq:fci} corresponding to the molecular ground
state can be determined by seeking the lowest eigenvalue of the matrix
representation of the Hamiltonian in the space of \acrshort{ON} vectors.
The \acrshort{FCI} method is exact, within the chosen one-particle set,
but scales exponentially with the number of electrons in the system and
thus has very limited practical applications.
Approximations can be tailored by appropriate truncations of the
$N$-electron space.
In \emph{single-reference} methods, one first determines an
approximation to the solution by means of a single \acrshort{ON} vector.
This \acrshort{ON} vector is treated as the \emph{physical} vacuum:
vectors in Fock space can be classified according to how different their
occupation is from the reference, \ie~\emph{by excitation
level}.\autocite{Helgaker2000-tz, Shavitt2009-mr}
A truncated expansion can then be constructed by including only those
\acrshort{ON} vectors that differ from the reference up to a certain
number of excitations.
Further details on how the expansions are actually tailored and
algorithmically implemented can be found elsewhere.\autocite{Helgaker2000-tz}
In the rest of this Chapter we will describe how a single \acrshort{ON}
vector approximation can be constructed, how we can improve on it by
means of \acrlong{CC} and \acrlong{MBPT} and how the properties of the
exact wave function are embedded into these ans\"{a}tze.

\section{Mean-Field Theory}\label{sec:mean-field}

The idea behind mean-field theory is simple: seek the best description
of the many-electron wave function using just one Slater determinant.
How does one direct this search towards the "best"? We will use the
variational principle and optimize the degrees of freedom in our
single-determinantal trial wave function accordingly.
It is evident that there is no variational freedom in the
$N$-electron space. All variational degrees of freedom reside in
the one-electron space, \ie~in the space of \glspl{MO}
$\lbrace\phi_r\rbrace$, used to build the determinant $\Ket{0}$.
The one-electron \glspl{MO} are thus optimized considering each single
electron in the mean field generated by the motion of all other
electrons, hence the name of the method. Clearly this neglects
parts of the electron--electron interaction energy, the \emph{electron
correlation}. However, in most cases, it provides a suitable starting
approximation for more sophisticated many-body treatments that recover
larger portions of the correlation energy.

Starting from an initial guess for the one-particle states, we
iteratively refine them by applying suitable rotations.
The iterations are carried out until a suitable convergence criterion
has been met, \ie the orbitals are \emph{self-consistent}.
The unitary rotation operator can be expressed as the exponential of a
one-electron, anti-Hermitian operator:
\begin{alignat}{3}
  U = \expo{-\kappa},
  \quad&
  \kappa = \sum_{rs}
  [\kappa_{rs} \cons{r}\anni{s} - \kappa^*_{rs}\cons{s}\anni{r}],
  \quad&
  \kappa^\dagger = -\kappa.
\end{alignat}
The energy of the system is now a function of the rotation parameters
$\kappa_{rs}, \kappa^*_{rs}$ and setting its gradient $\mat{E}^{[1]}$ to
zero will locate a stationary point. The gradient of the electronic
energy can be identified by comparing the Taylor and \gls{BCH}
commutator expansions of the Hamiltonian expectation value.
For a closed-shell this yields \emph{Brillouin's theorem}:
\begin{equation}\label{eq:brillouin}
  E^{[1]}_{ai} = -f_{ai}
 = h_{ai} + \sum_{j}[g_{aijj} - g_{ajji}] = 0,
\end{equation}
where $f_{ai}$ are elements of the \emph{Fock matrix} $\mat{F}$.
The two-electron terms appearing in the Fock matrix are called the
Coulomb and exchange integrals, respectively.
The stationarity condition implies that the Fock matrix is
block-diagonal in the basis of the optimal \glspl{MO}.
In the \emph{canonical representation} one seeks the set of orbitals
that make the Fock matrix diagonal. Hence the optimization problem is
equivalent to diagonalization of an effective one-electron operator:
\begin{equation}\label{eq:fock-eq}
 \mat{F}\vect{\phi} = \vect{\phi}\mat{\epsilon}
\end{equation}
where the eigenvalues of the Fock matrix are called \emph{orbital
energies}.

A different approach is taken in \gls{DFT}, where the electron density
is the central quantity in the theory, instead of the wave function.
The Hohenberg--Kohn theorems\autocite{Hohenberg1964-wo, Eschrig2012-as}
and their relativistic counterparts\autocite{Rajagopal1973-ns,
Dreizler2012-ay} establish the energy as a \emph{functional} of the
density.
The \gls{KS} approach to \acrshort{DFT} takes us a step further by
assuming the density of the system to be equal to that of a fictitious,
noninteracting system once again described by a single Slater
determinant.\autocite{Kohn1965-hg}
We rewrite the energy as a sum of five terms:
\begin{equation}\label{eq:ks-energy}
 E[\rho] = T_s[\rho] + V_\mathrm{ext}[\rho] + J[\rho] + E_\mathrm{xc}[\rho] + V_\mathrm{NN}
\end{equation}
the first four of which are functionals of the density. The first term
$T_s[\rho]$ is the kinetic energy of the fictitious noninteracting
system.
The second and third terms in Eq. \eqref{eq:ks-energy} represent,
respectively, the classical interaction of the electrons with the
external potential (including the nuclear attraction potential) and the
classical Coulomb interaction of the density with itself:
\begin{subequations}
 \begin{align}
   V_\mathrm{ext}[\rho] &= \int\diff\vect{r} V_\mathrm{ext}(\vect{r})\rho(\vect{r}) \\
   J[\rho] &=
   \frac{1}{2}\int\diff\vect{r}\int\diff\vect{r}^\prime
   \rho(\vect{r})g(\vect{r}, \vect{r}^\prime)\rho(\vect{r}^\prime)
 \end{align}
\end{subequations}
The fourth term in Eq. \eqref{eq:ks-energy} is the \gls{XC} functional.
This term accounts for the nonclassical part of the two-electron
interaction: electron exchange and electron correlation.
Moreover, it also corrects for the self-interaction present in $J[\rho]$
and the error introduced in the evaluation of the kinetic energy.
The exact form of this functional is not known and a number of
parametrized approximations exist.\autocite{Koch2015-wq}
In the \gls{LDA}, the functional is expressed in terms of an
\emph{energy density}, $e_\mathrm{xc}$, which is a local function of the
density:
\begin{equation}
 E^\mathrm{LDA}_\mathrm{xc}[\rho] = \int e_\mathrm{xc}(\rho(\vect{r}))\diff\vect{r}.
\end{equation}
In the \gls{GGA}, the energy density is a local function of both the
density and the norm of its gradient:
\begin{alignat}{2}
 E^\mathrm{GGA}_\mathrm{xc}[\rho] = \int
 e_\mathrm{xc}(\rho(\vect{r}),\zeta(\vect{r}))\diff\vect{r},
 \quad&
 \zeta(\vect{r}) \coloneq \vect{\nabla}\rho\cdot \vect{\nabla}\rho.
\end{alignat}
Finally, in \emph{hybrid} functionals, some proportion of the
\acrshort{HF} exchange is included:
\begin{equation}
 E^\mathrm{hybrid}_\mathrm{xc}[\rho] = E^\mathrm{GGA}_\mathrm{xc}[\rho] + \gamma E^\mathrm{HF}_\mathrm{x}[\rho]
\end{equation}
The \acrshort{KS}-\acrshort{DFT} state is optimized by the same
iterative process described above.
Repeated diagonalizations of the \acrshort{KS} matrix are carried out
until self-consistency is reached.
The \acrshort{KS} matrix:
\begin{equation}\label{eq:ksmatrix}
  f_{rs} = h_{rs} + \sum_{j}[g_{rsjj} - \gamma g_{rjjs}] + f_{\mathrm{xc};rs}.
\end{equation}
contains an \acrshort{XC} one-electron contribution due to the
in addition to the other terms contained in the Fock matrix.
The functional derivative of the \acrshort*{XC} functional enters in the
definition of this additional term:
\begin{alignat}{2}
  f_{\mathrm{xc}; rs}
  =
  \int\diff\vect{r}\Omega_{rs}(\vect{r})v_\mathrm{xc}(\vect{r}),
  \quad&
  v_\mathrm{xc}(\vect{r})
  \coloneq
  \frac{\delta E_\mathrm{xc}[\rho(\vect{r})]}{\delta \rho(\vect{r})}
\end{alignat}
notice moreover the exact exchange admixing factor $\gamma$ in the
two-electron part of the \acrshort*{KS} matrix.

How are \glspl*{MO} constructed? The usual approach is to expand them in
a basis of one-particle, atom-centered basis functions of known
functional form:
\begin{equation}
  \phi_r(\vect{r})
  =
  \sum_{\alpha=1}^{N_\mathrm{basis}}
  C_{\alpha r}\chi_{\alpha}(\vect{r})
\end{equation}
and optimize the expansion coefficients in the \acrshort*{SCF} procedure.
Choosing the one-particle \acrshort*{MO} space is then equivalent to
choosing the one-particle \gls{AO} space.
The functional form of the \acrshort*{AO} basis is chosen to strike a
balance between a physically accurate description of the short-range
Coulomb interaction and algorithmic robustness and
efficiency.\autocite{Helgaker2000-tz}
The usual choice, also adopted in this thesis, is to use bases of
Gaussian functions.\autocite{Helgaker1995-gi, Reine2012-tq}

\section{The Coupled Cluster Ansatz}\label{sec:coupled-cluster}

In the \acrlong*{CC} method we construct our correlated wave function as
an exponential mapping on top of a single reference
function:\autocite{Crawford2000-ey, Helgaker2000-tz, Bartlett2007-mz,
Shavitt2009-mr}
\begin{equation}
  \ket{\mathrm{CC}} = \expo{T}\ket{\mathrm{HF}},
\end{equation}
out of convenience we assume, here and in the following, that the
reference function is a closed-shell \acrshort{HF} wave function.
The \emph{cluster} operator appearing in the exponential is given as:
\begin{equation}
  T = \sum_{p=1}^\mathcal{M} T_p = \sum_{p=1}^\mathcal{M}\sum_{\mu_p}\tamp{\mu_p}\cluster{\mu_p}
\end{equation}
that is, as a truncated sum of excitation operators, $\cluster{\mu_p}$,
times the corresponding cluster amplitudes, $\tamp{\mu_p}$.
Here $\mu_p$ is the $\mu$-th excitation at the $p$-th excitation level and
$\mathcal{M}$ is the truncation level.
One of the main strengths of the \acrshort{CC} model is its size-extensivity
which stems directly from the exponential nature of the wave
operator.~\autocite{Shavitt2009-mr, Helgaker2000-tz}

The \acrshort{CC} method is not a variational but a \emph{projective} method.
Chosen the truncation level $\mathcal{M}$, one projects the
nonrelativistic Schrödinger equation for this ansatz on the excitation
manifold which comprises the reference function and all possible excited
determinants, up to the chosen truncation order:
\begin{subequations}
  \begin{align}
    \braket{\mathrm{HF} | \expo{-T}H\expo{T} | \mathrm{HF}} &= E_\mathrm{CC} \\
    \braket{\mathrm{exc} | \expo{-T}H\expo{T} | \mathrm{HF}} &= 0
  \end{align}
\end{subequations}
where $\bra{\mathrm{exc}}$ means any of the excited determinants in Fock
space compatible with the excitation level truncation.
Notice that we have also performed a \emph{similarity transformation} of
the Hamiltonian operator. This leads to the \emph{linked} form of the
\acrshort{CC} equations, which is manifestly size-extensive term-by-term.
Use of similarity transformed operators is ubiquitous when dealing with
\acrshort{CC} theory and we introduce the following notation for it:
\begin{equation}
  \overline{O} =\expo{-T}O\expo{T}
\end{equation}
The cluster operator is not Hermitian. Hence, the similarity transformation
will not, in general, preserve any of the symmetries, such as
hermiticity, that the bare operators might have possessed.
Similarity-transformed operators can be expanded in a \acrshort{BCH}
commutator series.
It can be shown that the \acrshort{BCH} expansion of the
similarity-transformed Hamiltonian \emph{exactly} truncates after the
four-fold nested commutator, greatly simplifying algebraic derivations
and manipulations.

Introducing the \gls{MP} partitioning of the Hamiltonian leads to
further insight:
\begin{alignat}{2}
 H = F + \Phi = \sum_r\epsilon_r\cons{r}\anni{r} + (g- V_\mathrm{HF}),
 \quad&
 V_\mathrm{HF} = \sum_{i}[g_{rsii} - g_{riis}]\cons{r}\anni{s}
\end{alignat}
where $F$ if the Fock matrix and $\Phi$ is the fluctuation potential.
Given our initial assumption on the reference function, the Fock
operator is diagonal and expressed in terms of spin-orbital energies and
number operators.
Its similarity transformation truncates after the second term and has a
relatively compact form:
\begin{equation}
  \overline{F} = F + \sum_{i}^4\sum_{\mu_i}\tamp{\mu_i}\cluster{\mu_i}\denom{\mu_i}
\end{equation}
where $\denom{\mu_i}$ is the difference in orbital energies between the
virtual and occupied spin-orbitals of excitation $i$.
For the fluctuation potential the similarity transformation truncates
after the fifth term, including up to four-fold nested commutators.

As formulated so far, the \acrshort{CC} method is not variational.
It is however possible to introduce a fully variational Lagrangian that
leads to the same amplitudes equations.\autocite{Helgaker1982-xl, Arponen1983-qt,
Helgaker1988-to, Helgaker1989-wl, Koch1990-vr, Kvaal2013-jr}
Let us call $\mathcal{E}(\vect{\eta})$ the definition of the energy
for the given quantum chemical method.
The \emph{amplitudes} $\vect{\eta}$ are determined by a set of
stationarity conditions $\mat{\Omega}(\vect{\eta}) = 0$.
Direct minimization of $\mathcal{E}(\vect{\eta})$ is thus a
\emph{constrained} optimization.
Introducing a set of Lagrange \emph{multipliers} $\bar{\vect{\eta}}$
lets us recast the problem as an unconstrained minimization of the
Lagrangian:
\begin{equation}
  \mathcal{L}(\vect{\eta}, \bar{\vect{\eta}}) =
  \mathcal{E}(\vect{\eta}) +
  \scalprod[W]{\bar{\vect{\eta}}}{\mat{\Omega}(\vect{\eta})}
\end{equation}
where the governing equations are obtained by differentiation with
respect to both sets of parameters:
\begin{subequations}
  \begin{align}
    \pderiv{\mathcal{L}(\vect{\eta}, \bar{\vect{\eta}})}{\bar{\vect{\eta}}}
    &= \mat{\Omega}(\vect{\eta}) = 0 \\
    \pderiv{\mathcal{L}(\vect{\eta}, \bar{\vect{\eta}})}{\vect{\eta}}
    &= \pderiv{\mathcal{E}(\vect{\eta})}{\vect{\eta}} +
    \scalprod[W]{\bar{\vect{\eta}}}{\pderiv{\mat{\Omega(\vect{\eta})}}{\vect{\eta}}}
    = 0
  \end{align}
\end{subequations}
The \acrshort*{CC} Lagrangian can thus be expressed as:
\begin{equation}\label{eq:cc-lagrangian}
  \begin{aligned}
    \mathcal{L}^\mathcal{M}(\tamp{}, \tbar{})
    &=
    \braket{\mathrm{HF} | \overline{H} | \mathrm{HF}}
    + \sum_{i=1}^{\mathcal{M}}\sum_{\mu_i}
    \tbar{\mu_i}\braket{\mu_i | \overline{H} | \mathrm{HF}} \\
    &=
  E_0
  + \sum_{i=1}^{\mathcal{M}}\tbar{\mu_i}\denom{\mu_i}\tamp{\mu_i}
  + \braket{\mathrm{HF} | \overline{\Phi} | \mathrm{HF}}
  + \sum_{i=1}^{\mathcal{M}}\braket{\tbar{i} | \overline{\Phi} | \mathrm{HF}}
  \end{aligned}
\end{equation}
where $E_0 = \sum_{i}\epsilon_i$ is the sum of the one-electron orbital
energies and the shorthand notation for the Lagrangian multiplier state (left
\acrshort*{CC} state) was introduced:
\begin{equation}
  \bra{\tbar{j}} = \sum_{\mu_j}\tbar{\mu_j}\bra{\mu_j}.
\end{equation}
Differentiation of the Lagrangian with respect to the multipliers
correctly yields the amplitudes equations, while differentiation with
respect to the amplitudes leads to the governing equations for the
multipliers:
\begin{subequations}
  \begin{align}
   \tampEq{\mu_i}(\tamp{}, \tbar{}, \p)  &=
   \denom{\mu_i}\tamp{\mu_i} + \braket{\mu_i | \overline{\Phi} | \mathrm{HF}}
             = 0 \label{eq:cc-amplitudes}\\
   \tbarEq{\mu_i}(\tamp{}, \tbar{}, \p)
    &=
    \denom{\mu_i}\tbar{\mu_i} +
    \braket{\mathrm{HF} | \commutator{\overline{\Phi}}{\cluster{\mu_i}} | \mathrm{HF}} +
    \sum_{j}^{\mathcal{M}}\braket{\tbar{j} |
    \commutator{\overline{\Phi}}{\cluster{\mu_i}} | \mathrm{HF}}
             = 0 \label{eq:cc-multipliers}
  \end{align}
\end{subequations}
While the multipliers are not needed for the evaluation of the
\acrshort{CC} energy, their calculation is mandatory when expectation values
and molecular properties in general are sought.
The \acrshort{CC} expectation values are formed using the left and
right \acrshort{CC} states and we introduce the following notation:
\begin{equation}
  O(\tamp{}, \tbar{}) = \braket{\mathrm{HF} | \overline{O} | \mathrm{HF} }
  + \sum_{i=1}^{\mathcal{M}}\braket{\tbar{i} | \overline{O} | \mathrm{HF} }
\end{equation}
When required by the context, we will explicitly write at which
truncation level in the cluster operator the expectation was evaluated:
$O^\mathcal{M}(\tamp{}, \tbar{})$.

\section{Many-Body Perturbation Theory}\label{sec:mbpt}

An alternative method to recover the correlation energy missing in the
mean-field approximation is to employ perturbation
theory.\autocite{Konishi2009-zb}
The single determinant optimized in the mean-field approximation is used
as zeroth-order wave function and the perturbation series is developed
considering the fluctuation potential in the \acrlong*{MP} partitioning
of the Hamiltonian as the perturbation.\autocite{McWeeny1992-oj, Helgaker2000-tz}
Notice that the partitioning of the Hamiltonian is not unique and
other choices are available.\autocite{Shavitt2009-mr}

As shown by \citeauthor{Koch1997-nm}, the \acrshort*{MBPT} series can be
derived from a \acrshort*{CC} ansatz for the wave function.
This ensures term-by-term size-extensivity of the energy at all
orders.\autocite{Helgaker2000-tz}
The governing equations
\eqref{eq:cc-amplitudes}--\eqref{eq:cc-multipliers} are expanded in
terms of the fluctuation potential. Energy corrections are identified
from the corresponding order expansion of the \acrshort*{CC} Lagrangian
and retaining only terms complying to the $2n+1$ and $2n+2$ rules.
\autocite{Helgaker1988-to, Helgaker1989-wl, Helgaker1992-ph}
A superscript index in square brackets - $[i]$ -  will denote an $i$-th
order contribution.

It is clear from the stationarity conditions that $\tamp{\mu_i}^{[0]} = 0, \,\forall i$ and
$\tbar{\mu_i}^{[0]} = 0, \, \forall i$.
Thus cluster operators can be of order 1 and higher. We introduce the
following notation for the $i$-th order cluster operators and
multipliers states:
\begin{alignat}{2}
  T_p^{[i]} = \sum_{\mu_p}\tamp{\mu_p}^{[i]}\cluster{\mu_p},
  \quad&
  \bra{\tbar{p}^{[i]}} = \sum_{\mu_p}\tbar{\mu_p}^{[i]}\bra{\mu_p}
\end{alignat}

To first order, one has:
\begin{equation}\label{eq:1st-order}
  \begin{aligned}
  \denom{\mu_2}\tamp{\mu_2}^{[1]}
  &= - \braket{\mu_2 | \Phi | \mathrm{HF}}
  = - \braket{\mathrm{HF} | \commutator{\Phi}{\cluster{\mu_2}} |
  \mathrm{HF}} \\
  &= \denom{\mu_2}\tbar{\mu_2}^{[1]}
  \end{aligned}
\end{equation}
which shows that singles, due to Brillouin's condition, and triples
amplitudes are of second and higher order.
To second order, one obtains:
\begin{equation}\label{eq:2nd-order}
  \begin{aligned}
  \denom{\mu_i}\tamp{\mu_i}^{[2]}
  &= - \braket{\mu_i | \commutator{\Phi}{T_2^{[1]}} | \mathrm{HF}}
  = - \braket{\tbar{2}^{[1]} | \commutator{\Phi}{\cluster{\mu_i}} |
  \mathrm{HF}} \\
  &= \denom{\mu_i}\tbar{\mu_i}^{[2]},\quad i = 1, 2, 3.
  \end{aligned}
\end{equation}
According to the $2n+1$ and $2n+2$ rules, energy corrections up to fifth
order can be obtained from amplitudes and multipliers up to second
order. Since the triples first appear to second order, the \gls{CCSD}
energy is correct to third order in the fluctuation potential.
The triples contributions to the fourth and fifth order corrections to
the energy are given as:
\begin{subequations}
  \begin{align}
    E_T^{[4]} &=
 \braket{\tbar{2}^{[1]}| \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}}
 \label{eq:4th-order-triples} \\
    E_T^{[5]} &=
    \braket{\tbar{1}^{[2]} | \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}}
  + \braket{\tbar{2}^{[2]} | \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}}
  \nonumber \\
  &+ \braket{\tbar{3}^{[2]} | \commutator{\Phi}{T_2^{[2]}} | \mathrm{HF}}
  + \braket{\tbar{3}^{[2]} | \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}}
  \nonumber \\
    &+
    \frac{1}{2}\braket{\tbar{3}^{[2]} |
    \commutator{\commutator{\Phi}{T_2^{[1]}}}{T_2^{[1]}}
    | \mathrm{HF}}.
 \label{eq:5th-order-triples}
  \end{align}
\end{subequations}
These expressions form the basis for the development of reduced-scaling
\acrshort*{CC} schemes were the double and triple excitation are treated
approximately. These are the subject of the next Section.

\section{Approximate Coupled Cluster Methods}\label{sec:cc-approximate}

The \acrshort*{CCSD} scheme, which scales as $N^6$, is really successful
in recovering a large portion of the correlation energy, but as hinted
at in the previous Section is only correct to third order in
perturbation theory.
Triple excitations are needed to get higher accuracy, but the full
\gls{CCSDT} model, with its steep $N^8$ scaling, is unfeasible for all
but the smallest systems.
One way around this problem is to exploit the perturbation theory
expression for the fourth and fifth order energy corrections of Eqs.
\eqref{eq:4th-order-triples}--\eqref{eq:5th-order-triples} to guide the
construction of approximate schemes for the inclusion of higher
excitations. These schemes can either be \emph{iterative} or
\emph{noniterative}.

In the iterative schemes, one approximates the amplitude equations for
the higher excitation to be correct up to a given order in perturbation
theory.
For the development of iterative schemes, we assume that $T_1 = O(0)$
and use $T_1$-transformed operators:
\begin{equation}
  \check{O} = \expo{-T_1}O\expo{T_1}.
\end{equation}
Since $T_1$ is a one-electron operator, the $T_1$-transformation does
not affect the particle rank of the electronic
Hamiltonian.\autocite{Koch1994-vr, Helgaker2000-tz}
The assumption that $T_1$ is of zeroth order is contrary to the usual
\acrshort*{MP} approach but highlights the role of the singles
amplitudes as orbital optimization parameters.
In the \gls{CC2} method, the amplitudes equations are:\autocite{Christiansen1995-vy, Helgaker2000-tz}
\begin{subequations}
  \begin{align}
    \denom{\mu_1}\tamp{\mu_1} &+ \braket{\mu_1 | \check{\Phi} +
    \commutator{\check{\Phi}}{Q_2} | \mathrm{HF}} = 0 \\
    \denom{\mu_2}\tamp{\mu_2} &+ \braket{\mu_2 | \check{\Phi} | \mathrm{HF}} = 0
  \end{align}
\end{subequations}
and are obtained from the \acrshort{CCSD} equations by retaining only
first order terms in the doubles equations.
The approximate doubles cluster operator was introduced:
\begin{equation}
  Q_2 = - \sum_{\mu_2}
  \denom{\mu_2}^{-1}\braket{\mu_2 | \check{\Phi} | \mathrm{HF}}\cluster{\mu_2}
\end{equation}
and we shall refer to it as quasi-$T_2$.
The \acrshort*{CC2} Lagrangian is constructed based on the approximate
equations obtained for the singles and
doubles:\autocite{Christiansen1995-vy, Helgaker2000-tz}
\begin{equation}\label{eq:cc2-lagrangian}
  \begin{aligned}
  \mathcal{L}_\mathrm{CC2}(\tamp{}, \tbar{})
  &=
  E_0
  + \sum_{i=1}^{\mathcal{2}}\tbar{\mu_i}\denom{\mu_i}\tamp{\mu_i}
  + \braket{\mathrm{HF} | \check{\Phi} + \commutator{\check{\Phi}}{Q_2} | \mathrm{HF}} \\
  &+ \sum_{\mu_1}\tbar{\mu_1}\braket{\mu_1 |
  \check{\Phi} + \commutator{\check{\Phi}}{Q_2}
  | \mathrm{HF}} \\
  &+ \sum_{\mu_2}\tbar{\mu_2}\braket{\mu_2 | \check{\Phi} | \mathrm{HF}}
  \end{aligned}
\end{equation}
The \acrshort*{CC2} methods brings the scaling of the \acrshort*{CCSD}
method down to $N^5$ in the iterative step.

The \gls{CC3} model is constructed analogously, the amplitudes
equations:\autocite{Christiansen1995-pv, Koch1997-nm, Helgaker2000-tz,
Smith2005-an}
\begin{subequations}
  \begin{align}
    \denom{\mu_1}\tamp{\mu_1} &+ \braket{\mu_1 |
    \check{\Phi} + \commutator{\check{\Phi}}{T_2}
    + \commutator{\check{\Phi}}{Q_3}
    | \mathrm{HF}} = 0 \\
    \denom{\mu_2}\tamp{\mu_2} &+ \braket{\mu_2 |
    \check{\Phi} + \commutator{\check{\Phi}}{T_2}
    + \frac{1}{2}\commutator{\commutator{\check{\Phi}}{T_2}}{T_2}
    + \commutator{\check{\Phi}}{Q_3}
    | \mathrm{HF}} = 0 \\
    \denom{\mu_3}\tamp{\mu_3} &+ \braket{\mu_3 |
    \commutator{\check{\Phi}}{T_2}
    | \mathrm{HF}} = 0
  \end{align}
\end{subequations}
are obtained from the \acrshort*{CCSDT} equations by retaining only
second order terms in the triples equation.
The approximate triples cluster operator was introduced:
\begin{equation}
  Q_3 = - \sum_{\mu_3}
  \denom{\mu_3}^{-1}\braket{\mu_3 | \commutator{\check{\Phi}}{T_2} | \mathrm{HF}}\cluster{\mu_3}
\end{equation}
and we shall refer to it as quasi-$T_3$.
The \acrshort*{CC3} Lagrangian is constructed based on the approximate
equations obtained for the singles, doubles and
triples:\autocite{Christiansen1995-pv, Koch1997-nm, Helgaker2000-tz, Smith2005-an}
\begin{equation}\label{eq:cc3-lagrangian}
  \begin{aligned}
  \mathcal{L}_\mathrm{CC3}(\tamp{}, \tbar{})
  &=
  E_0
  + \sum_{i=1}^{\mathcal{3}}\tbar{\mu_i}\denom{\mu_i}\tamp{\mu_i}
  + \braket{\mathrm{HF} | \check{\Phi} + \commutator{\check{\Phi}}{T_2} | \mathrm{HF}} \\
  &+ \sum_{\mu_1}\tbar{\mu_1}\braket{\mu_1 |
  \check{\Phi} + \commutator{\check{\Phi}}{T_2} + \commutator{\check{\Phi}}{Q_3}
  | \mathrm{HF}} \\
  &+ \sum_{\mu_2}\tbar{\mu_2}\braket{\mu_2 |
  \check{\Phi} + \commutator{\check{\Phi}}{T_2}
  + \frac{1}{2}\commutator{\commutator{\check{\Phi}}{T_2}}{T_2} + \commutator{\check{\Phi}}{Q_3}
  | \mathrm{HF}} \\
  &+ \sum_{\mu_3}\tbar{\mu_3}\braket{\mu_3 | \commutator{\check{\Phi}}{T_2} | \mathrm{HF}}
  \end{aligned}
\end{equation}
The \acrshort*{CC3} methods brings the scaling of the \acrshort*{CCSDT}
method down to $N^7$ in the iterative step.

Finally, one can construct \emph{noniterative} methods, where the
expensive $N^7$ step for the inclusion of connected triples is
calculated as a one-off correction on top of the converged
\acrshort*{CCSD} energy.
The expression for the correction is based on the fourth and fifth order
triples energy corrections Eqs.
\eqref{eq:4th-order-triples}--\eqref{eq:5th-order-triples}, but is
computed using the converged \acrshort*{CCSD} singles and doubles
amplitudes,\autocite{Urban1985-xp, Raghavachari1989-bn, Bartlett1990-lk,
Watts1993-ff, Kucharski1998-qq, Kucharski1998-oi, Crawford1998-vj,
Taube2008-xv, Taube2008-oq} here and in the following denoted by a $*$
superscript.
Since the left and right \acrshort*{CC} states differ, symmetric and
asymmetric variants of the noniterative corrections exist.

The $\Lambda\text{CCSD}[\text{T}]$\autocite{Eriksen2015-il} and
$\text{CCSD}[\text{T}]$\autocite{Urban1985-xp} methods only include the
fourth order correction Eq. \eqref{eq:4th-order-triples}.
The former uses both the left and right state, while the latter uses
only the right state and can be obtained from the former by replacing
the multipliers with the amplitudes:\autocite{Koch1997-nm,
Eriksen2015-il}
\begin{subequations}
  \begin{align}
    E_{\Lambda\text{[T]}} &= {}^* E^{[4]}_{\Lambda\text{[T]}} =
    \braket{\tbar{2}^{*}| \commutator{\Phi}{T_3^{*}} | \mathrm{HF}} \\
    E_{\text{[T]}} &= {}^* E^{[4]}_{\text{[T]}} = \braket{\tamp{2}^{*}|
    \commutator{\Phi}{T_3^{*}} | \mathrm{HF}}.
  \end{align}
\end{subequations}
The $\Lambda\text{CCSD}(\text{T})$\autocite{Kucharski1998-qq,
Kucharski1998-oi, Crawford1998-vj} and
$\text{CCSD}(\text{T})$\autocite{Raghavachari1989-bn} methods also
include the first of the fifth order triples corrections in Eq.
\eqref{eq:5th-order-triples}:
\begin{subequations}
 \begin{align}
  E_{\Lambda(\text{T})} = {}^* E^{[4]}_{\Lambda\text{[T]}} + {}^* E^{[5]}_{\Lambda\text{(T)}}
  &=
    \braket{\tbar{1}^{*} | \commutator{\Phi}{T_3^{*}} | \mathrm{HF}}
    +
    \braket{\tbar{2}^{*}| \commutator{\Phi}{T_3^{*}} | \mathrm{HF}}
    \\
  E_{(\text{T})} = {}^* E^{[4]}_{\text{[T]}} + {}^* E^{[5]}_{\text{(T)}}
  &=
    \braket{\tamp{1}^{*} | \commutator{\Phi}{T_3^{*}} | \mathrm{HF}}
    +
    \braket{\tamp{2}^{*}| \commutator{\Phi}{T_3^{*}} | \mathrm{HF}}
 \end{align}
\end{subequations}
once again, the symmetric method can be obtained from the asymmetric
variant by replacing multipliers with amplitudes in the left state.

Results from noniterative methods can be rationalized within the
framework of \acrshort*{MBPT}.\autocite{Stanton1997-lx, Koch1997-nm,
Eriksen2014-gy, Eriksen2015-il, Kristensen2016-od}
From Eqs. \eqref{eq:1st-order}--\eqref{eq:2nd-order}, one can derive
which \acrshort*{MBPT} terms are included in the corrections:
\begin{equation}
  \begin{aligned}
  {}^* E^{[4]}_{\Lambda\text{[T]}}
  &=
    \braket{\tbar{2}^{[1]}| \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}}
  + \braket{\tbar{2}^{[2]} | \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}} \\
  &+ \braket{\tbar{3}^{[2]} | \commutator{\Phi}{T_2^{[2]}} | \mathrm{HF}}
  + O(6)
  \end{aligned}
\end{equation}
and similarly for ${}^* E^{[4]}_{\text{[T]}}$.
The \acrshort*{MBPT} terms included in ${}^*
E^{[5]}_{\Lambda\text{(T)}}$ can be seen to be:
\begin{equation}
  {}^* E^{[5]}_{\Lambda\text{(T)}}
  =
  \braket{\tbar{1}^{[2]} | \commutator{\Phi}{T_3^{[2]}} | \mathrm{HF}}
  + O(6)
\end{equation}
and similarly for ${}^* E^{[5]}_{\text{(T)}}$.
