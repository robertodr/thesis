\chapter{Some Mathematical Results}\label{app:mathematical-results}

This appendix collects some results in the field of functional analysis and
boundary integral equations. No proofs or examples are given, the interested
reader is referred to the monographs by \citeauthor{Ern2004-oo},
\citeauthor{Hsiao2008-xb} and \citeauthor{Sauter2011-an}\autocite{Ern2004-oo,
Hsiao2008-xb, Sauter2011-an}

\section{Preliminary Definitions}

\begin{defin}[Sobolev spaces]
Let $s$ and $p$ be two integers with $s\geq 0$ and $1\leq p \leq +\infty$.
The so-called \emph{Sobolev space} $W^{s, p}(\Omega)$ is defined as
\begin{equation}
W^{s,p}(\Omega) =
\left\lbrace
u \in \mathcal{D}^\prime(\Omega) | \partial^\alpha u \in L^p(\Omega), |\alpha|\leq s
\right\rbrace
\end{equation}
where $\mathcal{D}^\prime(\Omega)$ is the space of Schwartz distributions and the
derivatives $\partial^\alpha u$ are understood in a distributional sense.
\end{defin}

\begin{lemma}[Hilbert Sobolev spaces]
Let $s\geq 0$. The space $H^s(\Omega) = W^{s, 2}(\Omega)$ is a Hilbert space
when equipped with the scalar product
\begin{equation}
(u, v)_{s, \Omega} = \sum_{|\alpha|\leq s}\int_\Omega\partial^\alpha u \partial^\alpha v.
\end{equation}
The associated norm is denoted by $\| \cdot \|_{s, \Omega}$.
\end{lemma}

\begin{defin}[Fractional Sobolev spaces]
For $0 < s < 1$ and $1 \leq p < +\infty$, the so-called \emph{Sobolev space with fractional
exponent} is defined as
\begin{equation}
W^{s, p}(\Omega) =
\left\lbrace
u \in L^p(\Omega) |
\frac{u(\vect{r}) - u(\vect{r}^\prime)}{\| \vect{r} - \vect{r}^\prime\|^{s+\frac{d}{p}}}
\in L^p(\Omega \times \Omega)
\right\rbrace.
\end{equation}
Furthermore, when $s> 1$ is not integer, letting $\sigma = s - [s]$, where $[s]$ is the integer
part of $s$, $W^{s,p}(\Omega)$ is defined as
\begin{equation}
W^{s, p}(\Omega) =
\left\lbrace
u \in W^{[s], p}(\Omega) |
\partial^\alpha u \in W^{\sigma, p}(\Omega)\, \forall \alpha,\, |\alpha| = [s]
\right\rbrace.
\end{equation}
When $p=2$, we denote $H^s(\Omega) = W^{s,2}(\Omega)$.
\end{defin}

\begin{defin}[Continuity]\label{def:continuity}
  A bilinear form on a normed vector space $V$ is \emph{bounded}, or
  \emph{continuous}, if there is a constant $C$ such that
  $\forall u, v \in V$:
  \[
  a(u, v) \leq C\lVert u\rVert\lVert v\rVert
  \]
\end{defin}

\begin{defin}[Coercivity]\label{def:coercivity}
  A bilinear form on a normed vector space $V$ is \emph{coercive},
  or \emph{elliptic}, if there is a constant $\alpha >0$ such that
  $\forall u \in V$:
  \[
  a(u, u) \geq \alpha\lVert u\rVert^2
  \]
\end{defin}
Coercivity implies that no eigenvalue of the linear operator associated to the
bilinear form can be zero, hence its invertibility.~\autocite{Ern2004-oo}

\begin{defin}[Abstract weak problem]\label{def:abstract-weak}
An abstract weak problem is posed as follows:
\begin{equation}
  \left\{
  \begin{aligned}
    &\text{Seek $u \in W$ such that:}\\
    &\forall v \in V \,\,\,\,\,
    a(u, v) = b(v)
  \end{aligned}
  \right.
  \label{eq:weak}
\end{equation}
where:
\begin{itemize}
  \item $W$ and $V$ are normed vector spaces. $W$ is the \emph{solution space},
  $V$ the \emph{test space}.
  \item $a$ is a \emph{continuous} bilinear form on $W \times V$.
  \item $b$ is a \emph{continous} linear form on $V$.
\end{itemize}
\end{defin}

\begin{defin}[Well-posedness]\label{def:hadamard}
The abstract weak problem in Definition \ref{def:abstract-weak} is
\emph{well-posed} if it admits one and only one solution and the solution is
bounded by the \emph{a priori} estimate:
\begin{equation}
\exists c > 0, \forall f \in V^\prime, \|u\|_W \leq c \|f\|_{V^\prime}
\end{equation}
where $V^\prime$ is the dual space of $V$.
\end{defin}

\begin{defin}[Transmission problem]
We assume Euclidean space $\mathbb{R}^3$ to be partitioned into two subdomains
$\Omegai$ and $\Omegae$ sharing a boundary $\Gamma$. We further assume that
$\Omegai$ is a closed domain, entirely contained inside $\Omegae$.
The transmission problem is posed as follows:
\begin{subequations}\label{eq:transmission-general}
\begin{align}[left={\empheqlbrace}]
  \Li u &= f_\mathrm{i} \,\, \text{in}\,\, \Omegai \\
  \Le u &= f_\mathrm{e} \,\, \text{in}\,\, \Omegae \\
  [u] &= \ue - \ui = g_\mathrm{D} \,\, \text{on}\,\, \Gamma
   \\
[\partial_L u] &= \partiale u - \partiali u = g_\mathrm{N} \,\,
\text{on}\,\, \Gamma \\
|u(\vect{r})| &\leq C \|\vect{r} \|^{-1} \,\,\text{for}\,\,\| \vect{r} \|\rightarrow\infty
\end{align}
\end{subequations}
where the differential operators are assumed elliptic and the jump conditions are
given in terms of Dirichlet $g_\mathrm{D}$ and Neumann $g_\mathrm{N}$ data.
\end{defin}

\section{Derivation of the IEF equation}
I will show a detailed derivation of the \acrshort{IEF} equation
for the \acrshort{PCM} transmission problem Eq.~\eqref{eq:transmission}:
\begin{subequations}
  \begin{align}[left={\empheqlbrace}]
  \Li u &= \nabla^2 u = -4\pi\rhoi \,\, \text{in}\,\, \Omegai \\
  \Le u &= 0 \,\, \text{in}\,\, \Omegae \\
  [u] &= \ue - \ui = 0 \,\, \text{on}\,\, \Gamma \\
[\partial_L u] &= \partiale u - \partiali u = 0 \,\, \text{on}\,\, \Gamma \\
|u(\vect{r})| &\leq C \|\vect{r} \|^{-1} \,\,\text{for}\,\,\| \vect{r} \|\rightarrow\infty
\end{align}
\end{subequations}

We first state two important results in the theory of boundary integral
equations.
\begin{lemma}[Properties of the boundary integral operators]
  The integral operators introduced in Eqs.~\eqref{eq:S}-\eqref{eq:D-dagger}
  enjoy the following properties~\autocite{Hsiao2008-xb, Sauter2011-an}:
  \begin{enumerate}
      \item on $L^2(\Gamma)$, $\bi{S}_\star$ is self-adjoint,
        $\bi{D}^\dagger_\star$ is the adjoint operator of
        $\bi{D}_\star$.
      \item The commutation relations hold:
        \begin{alignat}{2}
          \bi{D}_\star\bi{S}_\star = \bi{S}_\star\bi{D}^\dagger_\star, \quad&
          \bi{S}_\star\bi{D}_\star = \bi{D}^\dagger_\star\bi{S}_\star
        \end{alignat}
      \item The boundary integral operators are continuous
        mappings between Sobolev spaces of fractional order:
        \begin{subequations}
          \begin{align}
   \bi{S}_\star &: H^{-\frac{1}{2}}(\Gamma) \rightarrow H^{\frac{1}{2}}(\Gamma) \\
   \bi{D}_\star &: H^{\frac{1}{2}}(\Gamma) \rightarrow H^{\frac{1}{2}}(\Gamma) \\
   \bi{D}^\dagger_\star &: H^{-\frac{1}{2}}(\Gamma) \rightarrow H^{-\frac{1}{2}}(\Gamma)
          \end{align}
        \end{subequations}
      \item The operator $\bi{S}_\star$ is coervice and admits a
        continuous inverse in the aforementioned Sobolev spaces.
      \item The operators $\lambda - \bi{D}_\star$ and $\lambda -
        \bi{D}^\dagger_\star$ with $\lambda \in (-2\pi, +\infty)$
        admit a continuous inverse in the aforementioned
        Sobolev spaces.
  \end{enumerate}
\end{lemma}

\begin{lemma}[Integral Representation]
For the transmission problem \ref{eq:transmission-general} there holds:
\begin{enumerate}
\item $\forall \vect{r} \in \Omegai$
\begin{equation}
u = \bi{S}_\mathrm{i}(\partiali u)
- \bi{D}_\mathrm{i}(\ui) + \int_{\Omegai} \Gi f_\mathrm{i}\diff \vect{r}^\prime
\end{equation}
\item $\forall \vect{r} \in \Omegae$
\begin{equation}
u = -\bi{S}_\mathrm{e}(\partiale u)
+ \bi{D}_\mathrm{e}(\ue) + \int_{\Omegae}\Ge f_\mathrm{e}\diff \vect{r}^\prime
\end{equation}
\item $\forall \vect{r} \in \Gamma$
  \begin{equation}\label{eq:stat3}
    \frac{1}{2}\ui = \bi{S}_\mathrm{i}(\partiali u)
    - \bi{D}_\mathrm{i}(\ui) + \int_{\Omegai}\Gi f_\mathrm{i}\diff \vect{r}^\prime
  \end{equation}
\item $\forall \vect{r} \in \Gamma$
  \begin{equation}\label{eq:stat4}
    \frac{1}{2}\ue = -\bi{S}_\mathrm{e}(\partiale u)
    + \bi{D}_\mathrm{e}(\ue) + \int_{\Omegae}\Ge f_\mathrm{e}\diff \vect{r}^\prime
  \end{equation}
\end{enumerate}
\end{lemma}

We introduce the following auxiliary potential:
\begin{subequations}
\begin{empheq}[left={h(\vect{r}) = \empheqlbrace}]{align}
    &\int_{\mathbb{R}^3}\Gi\rhoi(\vect{r}^\prime)\diff \vect{r}^\prime  \quad \vect{r} \in \Omegai \\
    &\int_{\mathbb{R}^3}\Ge\rhoi(\vect{r}^\prime)\diff \vect{r}^\prime  \quad \vect{r} \in \Omegae
\end{empheq}
\end{subequations}
for which we have:
\begin{subequations}
\begin{empheq}[left={\empheqlbrace}]{align}
    \nabla^2 h &= \rhoi \,\, \text{in}\,\, \Omegai \\
    \Le h &= 0 \,\, \text{in}\,\, \Omegae
\end{empheq}
\end{subequations}
We then define the \emph{reaction potential} as:
\begin{equation}
  \xi = u - h
\end{equation}
such that:
\begin{subequations}
  \begin{align}[left={\empheqlbrace}]
  \nabla^2 \xi &= 0 \,\, \text{in}\,\, \Omegai \\
  \Le \xi &= 0 \,\, \text{in}\,\, \Omegae \\
  -[\xi] &= [h] \,\, \text{on}\,\, \Gamma \\
  -[\partial_L \xi] &= [\partial_L h] \,\, \text{on}\,\, \Gamma
\end{align}
\end{subequations}
inside the cavity, the reaction potential can be represented by a
\emph{single layer potential}:
\begin{equation}
  \xi_\mathrm{i} = \bi{S}_\mathrm{i}\sigma
\end{equation}
where the function $\sigma$ is the, yet unknown, \acrlong*{ASC}.

To derive an equation for $\sigma$, we set up a system of equations containing
the jump conditions and the integral representations of the reaction and auxiliary potentials:
\begin{subequations}
\begin{empheq}[left={\empheqlbrace}]{align}
    &\bi{S}_\mathrm{i}(\partiali \xi) - \bi{D}_\mathrm{i}(\xi_\mathrm{i})
    = \frac{1}{2}\xi_\mathrm{i} \label{eq:first} \\
    &\bi{S}_\mathrm{e}(\partiale \xi) - \bi{D}_\mathrm{e}(\xi_\mathrm{e})
    = -\frac{1}{2}\xi_\mathrm{e} \label{eq:second} \\
  &\bi{S}_\mathrm{e}(\partiale h) - \bi{D}_\mathrm{e}(h_\mathrm{e})
  = -\frac{1}{2}h_\mathrm{e} \label{eq:third} \\
  &\xi_\mathrm{i} - \xi_\mathrm{e} = h_\mathrm{e} - h_\mathrm{i}
  \label{eq:fourth} \\
  &\partiali \xi - \partiale \xi = \partiale h - \partiali h
  \label{eq:fifth}
\end{empheq}
\end{subequations}
The final ingredient is the \gls{DtN} map, which can be derived by employing Eq.~\eqref{eq:stat3}
to the Newton potential:
\begin{equation}
  \phi(\vect{r}) = (\bi{N}\rhoi)(\vect{r}) = \int_{\mathbb{R}^3}\Gi\rhoi(\vect{r}^\prime)\diff \vect{r}^\prime
   = \left.h(\vect{r})\right|_{\Omegai}
\end{equation}
which is equal, in $\Omegai$, to the auxiliary potential $h(\vect{r})$.
The \acrshort{DtN} map is thus given as:
\begin{equation}\label{eq:regular-DtN}
   \left(\frac{1}{2} - \bi{D}_\mathrm{i}\right)\phi_\mathrm{i}
      +\bi{S}_\mathrm{i}(\partiali \phi) = 0
\end{equation}
With this last ingredient at hand, algebraic manipulations lead to the \acrshort{IEF}
equation:
\begin{equation}
  \left[ \bi{S}_\mathrm{e}\left(2\pi + \bi{D}^\dagger_\mathrm{i}\right)
  +
  \left(2\pi - \bi{D}_\mathrm{e}\right)\bi{S}_\mathrm{i}
  \right]\sigma =
  -\left[\left(2\pi-\bi{D}_\mathrm{e}\right)
  -\bi{S}_\mathrm{e}\bi{S}_\mathrm{i}^{-1}
  \left(2\pi-\bi{D}_\mathrm{i}\right)
  \right]\esp,
  \tag{\ref{eq:full-IEF} from Chapter \ref{ch:CSM}}
\end{equation}

\section{Weak Formulation of Partial Differential Equations}\label{sec:weak}

In this Section, I will show how one can reformulate the transmission problem
into a variational formulation.
Such a formulation allows for a larger vector space, with weaker regularity
conditions, to be explored as solution space for the problem.
We will follow the exposition of \citeauthor{Ern2004-oo} quite closely
in introducing the \emph{weak} formulation of \glspl{PDE}.
For simplicity, we assume Dirichlet boundary conditions for a conductor,
\ie the basic assumption behind \acrshort{COSMO}.
The \emph{strong} formulation of the electrostatic problem then reads:
\begin{equation}\label{eq:poisson-cosmo}
  \nabla^2\esp = -4\pi\rho,
  \quad \esp \in \mathcal{C}^2_0(\Omegai),
\end{equation}
where $\mathcal{C}^2_0(\Omegai)$ is the vector space of twice
continuously differentiable functions in $\Omegai$ with null trace on
$\Gamma$.
We can relax this regularity requirement on $\Psi$ by introducing the
\emph{Hilbert Sobolev space} of test functions $H_0^1(\Omegai)$:
\begin{equation}
  H_0^1(\Omegai) = \lbrace
  f : \Omegai \rightarrow \mathbb{R}
  | f, \nabla f \in L^2(\Omegai), f_\Gamma = 0
  \rbrace.
\end{equation}
Projecting the differential problem onto this space and using the
$\eta\nabla^2\gamma = \nabla\cdot(\eta\nabla\gamma) - \nabla\eta\cdot\nabla\gamma$ identity
one obtains the \emph{weak} formulation of the differential problem:
\begin{equation}\label{eq:poisson-weak}
  \left\{
  \begin{aligned}
    &\text{Seek $\Psi \in H_0^1(\Omegai)$ such that:}\\
    &(\nabla\zeta, \nabla\Psi) =
    -4\pi(\zeta, \rho) \quad
    \forall \zeta\in H_0^1(\Omegai)
  \end{aligned}
  \right.
\end{equation}
The form $(\nabla\cdot, \nabla\cdot)$ is \emph{bilinear} and continuous
in $H_0^1(\Omegai)\times H_0^1(\Omegai)$, while $-4\pi(\cdot, \rho)$ is
\emph{linear} and continuous in $H_0^1(\Omegai)$.
We rewrite Eq.~\eqref{eq:poisson-weak} in the abstract form:
\begin{equation}
  \left\{
  \begin{aligned}
    &\text{Seek $u \in V$ such that:}\\
    &\forall v \in V \,\,\,\,\,
    a(u, v) = b(v)
  \end{aligned}
  \right.
  \tag{\ref{eq:weak}}
\end{equation}
and state the following fundamental results:
\begin{lemma}[Lax--Milgram]
  If the bilinear form $a$ is \emph{continous} and \emph{coercive}
  in $V$, then, for any continuous linear form $b$, Problem~\eqref{eq:weak} is
  \emph{well-posed}.
\end{lemma}
\begin{corollary}[Variational property]
  If the bilinear form is \emph{symmetric} and \emph{positive}
  the unique solution to Problem \eqref{eq:weak} is
  the \emph{unique minimum} on $V$ of the functional:
  \[
  \mathcal{F}(u) = \frac{1}{2}a(u, u) - b(u)
  \]
\end{corollary}

It is important to note how \glspl{BIE} can also be reformulated in a
variational framework, as shown in \noparcite[ref.][]{Hsiao2008-xb}

\section{The Galerkin Method}

\todo[inline]{Write this section}
Approximability, conformity, consistency and asymptotic consistency
of the approximation setting, $\inf$-$\sup$ condition, Céa's Lemma
and generalized $\inf$-$\sup$ condition.~\autocite{Ern2004-oo}

